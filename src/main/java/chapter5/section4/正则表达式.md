# 正则表达式

## 使用正则表达式描述模式
* 此文中正则表达式起始与左括号，结束于右括号。
* 连接操作
  * 写AB时表示指定了两个字符A和B，由A和B连接后构成。
* 或操作
  * 用竖线｜表示
  * A｜B表示的是A或者B
  * 优先级低于连接操作
* 闭包操作
  * 用*表示
  * 模式的闭包由将模式和自身连接任意多次（包括零次）而得到的所有字符串所组成的语言。
  * 闭包的优先级高于连接
  * AB*表示A和0个或多个B组成
  * 空字符串的记号是 epsilon

* 括号
  * 可以用来改变默认优先的顺序
  * （AB）* 表示 空字符串 AB ABAB ABABAB

* 定义 一个正则表达式可以是
  * 空字符串Є；
  * 单个字符；
  * 包含在括号中的另一个正则表达式；
  * 两个或多个连接起来的正则表达式；
  * 由或运算符分隔的两个或多个正则表达式；
  * 由闭包运算符标记的一个正则表达式。

* 定义（续） 每个正则表达式表示的是一个字符串的集合，它们的定义如下所述。
  * 空正则表达式表示的字符串的集合为空，含有0个元素。
  * 一个字符表示的字符串的集合含有一个元素，即该字符本身。
  * 一个由括号和包含在其中的正则表达式组成的正则表达式表示的字符串的集合与括号内的正则表达式相同。
  * 由两个正则表达式连接起来的正则表达式表示的字符串的集合为这两个正则表达式分别表示的字符串集合的叉乘。（按照正则表达式中指定的顺序，由一个字符串集合中的元素和另一个字符串集合中的元素相连接所能够组合而成的所有字符串。）
  * 由或运算符连接的两个正则表达式所表示的字符串的集合为两个正则表达式所分别表示的字符串集合的并集。
  * 由一个正则表达式的闭包所表示的字符串的集合由Є（空字符串）或将被修饰的正则表达式所表示的字符串集合重复任意次所得到的所有字符串所组成。
  
## 缩略写法
* 字符描述集
  * . 能够表述任意一个字符。
  * ^ 开头的字符，在方括号表示的就是任意非该括号内的字符
  * 图示
    * ！[字符描述集](image/字符描述集.png)
* 闭包的简写
  * 图示
    * ！[闭包的简写](image/闭包的简写.png)
* 转义序列
  * 通过\可以将元字符（｜，* "（" "）" ）转译为字母表中的字符
  * \t 制表符 \n 换行 \s 任意空白字符

## 正则表达式的实际应用
* 字符串查找
* 合法性检查
* 局限
  * 无法确定括号的完整性，A和B数量是否相等。

## 非确定有限状态自动机（NFA）
* Kleene定理证明了，对于任意正则表达式都存在一个与之对应的非确定有限状态自动机（反之亦然）
* NFA的性质
  * 长度为的正则表达式中的每个字符在所对应的NFA中都有且只有一个对应的状态。NFA的起始状态为0并含有一个（虚拟的）接受状态M。
  * 字母表中的字符所对应的状态都有一条从它指出的边，这条边指向模式中的下一个字符所对应的状态（图中的黑色的边）。
  * 元字符“(”、“)”、“|”和“*”所对应的状态至少含有一条指出的边（图中的红色的边），这些边可能指向其他的任意状态。
  * 有些状态有多条指出的边，但一个状态只能有一条指出的黑色边。
* NFA的两种状态转换
  * **匹配转换：** 如果当前和字母表中的一个字符相对应且文本中的当前字符和该字符相匹配，自动机可以扫过文本中的该字符并转换到下一个状态。
  * **epsilon转换：** 自动机可以通过红色的边转换到另一个状态而不扫描文本中任何字符。
* 当且仅当一个NFA从状态0开始从头读取了一段文本中的**所有字符**，进行了一系列的状态转换并最终到达了接受状态时，则称该NFA识别了一个字符串。
* NFA的运行
  * 从第一个状态（"（"）开始搜集epsilon转换能够到达的所有状态。
  * 根据步骤1搜集到的状态，在文本中取匹配第一个字符。
  * 如果匹配成功，则对第一个匹配成功的下一个状态急性epsilon转换，搜集所有能够到达的状态。
  * 上述步骤一直持续到文本扫描完毕位置。
* **命题Q：** 判定一个长度为M的正则表达式所对应的NFA能否识别一段长度为N的文本所需的时间在最坏请款下和MN成正比。】
* 图示
  * ！[NFA运行](image/NFA运行.png)

* NFA的构建
  * 连接操作
    * 状态的匹配转换和字母表中的字符的对应关系就是连接操作的实现。
  * 括号
    * 正则表达式字符串中所有左括号的索引压入栈中。
  * 闭包操作
    * 闭包运算符只可能出现在i单个字符之后（此时在单个字符和*之间建立相互连接的epsilon转换），或者是右括号之后，将在对应的左括号和"\*"之间相互指向的两条epsilon转换。
  * 或表达式 （A｜B）为例
    * 添加两条epsilon转换，一条从左括号所对应的状态指向B中的第一个字符所对应的状态，另一个从｜字符所对应的状态指向右括号对应的状态。
  

  * **命题R：** 构造和长度为M的正则表达式相对应的NFA所需的时间和空间在最坏情况下与M成正比。